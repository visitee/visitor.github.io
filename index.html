<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Login for Data</title><style>
table,th,td{border:1px solid black;border-collapse:collapse;padding:8px;text-align:left;}th,td{width:120px;}
#printButton,#searchBar,#loadingMessage,#sortMenu{margin-top:20px;display:none;}#loadingMessage{font-size:16px;color:gray;}</style></head>
<body>
<center><h1>Data Viewer (beta)</h1><form id="loginForm"><label for="username">Username:</label><input type="text" id="username" required><br><br><label for="password">Password:</label><input type="password" id="password" required><br><br><button type="submit">Login</button></form><p id="message" style="color: red;"></p><p id="loadingMessage">Fetching data, please wait...</p><div id="sortMenu"><label for="sortSelect">â‡…</label><select id="sortSelect"><option value="oldest">Oldest to Latest</option><option value="latest">Latest to Oldest</option><option value="highest">Highest to Lowest</option></select></div><div id="searchBar"><label for="searchInput">ðŸ”Žï¸Ž</label><input type="text" id="searchInput" placeholder="Enter time (e.g., 10/1/2024)"><button id="searchButton">Search</button></div><table id="groupTable" style="margin-top:20px; display:none;"><thead><tr><th>Timestamp</th><th>Media</th><th>Language</th><th>Group</th><th>Minute</th></tr></thead><tbody id="tableBody"></tbody><tfoot id="tableFooter"></tfoot></table><button id="printButton" onclick="printData()">Print</button></center><script>
const encodedAPI='aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2FuYWx5c29yL2RhdGEtc2ltdWxhdG9yL21hc3Rlci9iMzlmYWUzOTZlMGU0YjlhMzU5Y2RkYThkMDYwMDQyMWU3NDQ4ZTFiNjkyZA==';const encodedEndpoint='aHR0cHM6Ly92aWV3ZXIuY2FsY3Vpcy51cy9hZDA0MGM1NWNmYzY3M2RiNjkyZA==';const dataUrl=atob(encodedAPI);const userUrl=atob(encodedEndpoint);let fullUserData=[];function toggleLoading(show){document.getElementById('loadingMessage').style.display=show?'block':'none';}
async function fetchJson(url){toggleLoading(true);try{const response=await fetch(url);const data=await response.json();toggleLoading(false);return data;}catch(error){console.error("Error fetching data:",error);document.getElementById("message").textContent="Failed to load data.";toggleLoading(false);return null;}}
function displayGroupData(userData){const tableBody=document.getElementById('tableBody');const tableFooter=document.getElementById('tableFooter');tableBody.innerHTML='';tableFooter.innerHTML='';let totalMinutes=0;userData.forEach(record=>{const row=document.createElement('tr');row.innerHTML=`<td>${record.timestamp}</td><td>${record.media}</td><td>${record.language}</td><td>${record.id}</td><td>${record.minutes}</td>`;tableBody.appendChild(row);totalMinutes+=record.minutes;});const totalRow=document.createElement('tr');totalRow.innerHTML=`<td colspan="4"><strong>Total</strong></td><td><strong>${totalMinutes}</strong></td>`;tableFooter.appendChild(totalRow);document.getElementById('groupTable').style.display='table';document.getElementById('searchBar').style.display='block';document.getElementById('sortMenu').style.display='block';document.getElementById('printButton').style.display='block';}
function sortData(criteria){let sortedData=[...fullUserData];if(criteria==='latest'){sortedData.sort((a,b)=>new Date(b.timestamp)-new Date(a.timestamp));}else if(criteria==='oldest'){sortedData.sort((a,b)=>new Date(a.timestamp)-new Date(b.timestamp));}else if(criteria==='highest'){sortedData.sort((a,b)=>b.minutes-a.minutes);}
displayGroupData(sortedData);}
function filterByTimestamp(searchValue){const filteredData=fullUserData.filter(record=>record.timestamp.includes(searchValue.trim()));displayGroupData(filteredData);}
document.getElementById('loginForm').addEventListener('submit',async function(event){event.preventDefault();const username=document.getElementById('username').value.trim();const password=document.getElementById('password').value;const messageElement=document.getElementById('message');const users=await fetchJson(userUrl);if(!users)return;const user=users.find(u=>u.id===username);if(user&&user.password===password){messageElement.textContent="";const data=await fetchJson(dataUrl);if(data){const userData=data.filter(item=>item.interpreter===username);if(userData.length>0){fullUserData=userData;displayGroupData(userData);}else{messageElement.textContent="No data found for this user.";}}}else{messageElement.textContent="â›” authentication failed.";}});document.getElementById('searchButton').addEventListener('click',function(){const searchValue=document.getElementById('searchInput').value;filterByTimestamp(searchValue);});document.getElementById('sortSelect').addEventListener('change',function(){sortData(this.value);});function printData(){const printContents=document.getElementById('groupTable').outerHTML;const originalContents=document.body.innerHTML;document.body.innerHTML=printContents;window.print();document.body.innerHTML=originalContents;document.getElementById('printButton').style.display='block';}</script>
</body>
</html>
